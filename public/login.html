<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login - IDAIC Members</title>
<script src="https://cdn.tailwindcss.com"></script>
<link
href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
rel="stylesheet"
/>
<style> body { font-family: 'Inter', sans-serif; } </style>
<script>
  // Tab switching function - supports OTP and Password
  window.switchTab = function(tab) {
    const otpTab = document.getElementById('otp-tab');
    const passwordTab = document.getElementById('password-tab');
    const otpContent = document.getElementById('otp-content');
    const passwordContent = document.getElementById('password-content');

    if (tab === 'otp') {
      // Activate OTP tab
      if (otpTab) {
        otpTab.classList.add('border-[#FF9900]', 'text-[#FF9900]');
        otpTab.classList.remove('border-transparent', 'text-[#DCDCDC]');
      }
      if (passwordTab) {
        passwordTab.classList.add('border-transparent', 'text-[#DCDCDC]');
        passwordTab.classList.remove('border-[#FF9900]', 'text-[#FF9900]');
      }

      // Show OTP content, hide password content
      if (otpContent) otpContent.classList.remove('hidden');
      if (passwordContent) passwordContent.classList.add('hidden');

      // Make password form fields non-focusable (but don't disable - just hide the container)
      const pwdEl = document.getElementById('password');
      const pwdEmailEl = document.getElementById('password-email');
      if (pwdEl) {
        pwdEl.value = '';
        pwdEl.setAttribute('tabindex', '-1');
      }
      if (pwdEmailEl) {
        pwdEmailEl.setAttribute('tabindex', '-1');
      }

      // Make OTP form fields focusable
      const emailEl = document.getElementById('email');
      const codeEl = document.getElementById('code');
      if (emailEl) {
        emailEl.removeAttribute('tabindex');
      }
      if (codeEl) {
        codeEl.removeAttribute('tabindex');
      }
    } else if (tab === 'password') {
      // Activate password tab
      if (passwordTab) {
        passwordTab.classList.add('border-[#FF9900]', 'text-[#FF9900]');
        passwordTab.classList.remove('border-transparent', 'text-[#DCDCDC]');
      }
      if (otpTab) {
        otpTab.classList.add('border-transparent', 'text-[#DCDCDC]');
        otpTab.classList.remove('border-[#FF9900]', 'text-[#FF9900]');
      }

      // Show password content, hide OTP content
      if (passwordContent) passwordContent.classList.remove('hidden');
      if (otpContent) otpContent.classList.add('hidden');

      // Make OTP form fields non-focusable (but don't disable - just hide the container)
      const emailEl = document.getElementById('email');
      const codeEl = document.getElementById('code');
      if (emailEl) {
        emailEl.value = '';
        emailEl.setAttribute('tabindex', '-1');
      }
      if (codeEl) {
        codeEl.value = '';
        codeEl.setAttribute('tabindex', '-1');
      }

      // Make password form fields focusable
      const pwdEl = document.getElementById('password');
      const pwdEmailEl = document.getElementById('password-email');
      if (pwdEl) {
        pwdEl.removeAttribute('tabindex');
      }
      if (pwdEmailEl) {
        pwdEmailEl.removeAttribute('tabindex');
      }

      // Reset OTP forms
      const req = document.getElementById('otp-request-form');
      const ver = document.getElementById('otp-verify-form');
      if (req) req.classList.remove('hidden');
      if (ver) ver.classList.add('hidden');
    }
  };

  // Initialize tabindex on page load
  window.addEventListener('DOMContentLoaded', () => {
    // OTP tab is active by default, so password fields should be non-focusable
    const pwdEl = document.getElementById('password');
    const pwdEmailEl = document.getElementById('password-email');
    if (pwdEl) {
      pwdEl.setAttribute('tabindex', '-1');
    }
    if (pwdEmailEl) {
      pwdEmailEl.setAttribute('tabindex', '-1');
    }
  });
</script>
</head>
<body
class="bg-black text-[#FAFAFA] min-h-screen flex flex-col items-center justify-start pt-16"
>
<!-- Logo -->
<div class="mb-10">
<a href="https://www.idaic.org" target="_blank" rel="noopener noreferrer" class="inline-block">
<img
src="https://raw.githubusercontent.com/nexusclimate/idaic/main/idaic_black.png"
alt="IDAIC Logo"
class="h-28 hover:opacity-80 transition-opacity duration-200"
/>
</a>
</div>

<!-- Login Box -->
<div
class="w-full max-w-md p-8 space-y-6 bg-[#1a1a1a] rounded-xl shadow-xl mt-4"
>
<h2 class="text-center text-2xl font-bold">IDAIC Members</h2>

<!-- Tab Navigation -->
<div class="flex border-b border-[#2b2b2b] mb-6">
<button
id="otp-tab"
class="flex-1 py-3 px-4 text-center font-medium border-b-2 border-[#FF9900] text-[#FF9900] transition-colors duration-200"
onclick="window.switchTab('otp')"
>
Email Code
</button>
<button
id="password-tab"
class="flex-1 py-3 px-4 text-center font-medium border-b-2 border-transparent text-[#DCDCDC] hover:text-[#FAFAFA] transition-colors duration-200"
onclick="window.switchTab('password')"
>
Password
</button>
</div>


<!-- OTP Login Tab Content -->
<div id="otp-content" class="space-y-5">
<!-- ① Request OTP -->
<form id="otp-request-form" class="space-y-5">
<div>
<label for="email" class="block mb-1">Email</label>
<input
id="email"
type="email"
required
autocomplete="email"
class="w-full px-4 py-2 rounded-lg bg-[#2b2b2b] border border-[#DCDCDC] text-[#FAFAFA] focus:outline-none focus:ring-2 focus:ring-[#FF9900]"
placeholder="you@example.com"
/>
</div>
<button
type="submit"
class="w-full py-2 bg-[#FF9900] hover:bg-orange-600 text-black rounded-lg font-semibold"
>
Send code
</button>
</form>

<!-- ② Verify OTP -->
<form id="otp-verify-form" class="space-y-5 hidden">
<div>
<label for="code" class="block mb-1">Enter code</label>
<input
id="code"
type="text"
maxlength="6"
required
autocomplete="one-time-code"
class="w-full px-4 py-2 rounded-lg bg-[#2b2b2b] border border-[#DCDCDC] text-[#FAFAFA] focus:outline-none focus:ring-2 focus:ring-[#FF9900]"
placeholder="123456"
/>
</div>
<button
type="submit"
class="w-full py-2 bg-[#FF9900] hover:bg-orange-600 text-black rounded-lg font-semibold"
>
Verify &amp; Sign in
</button>
</form>
</div>

<!-- Password Login Tab Content -->
<div id="password-content" class="space-y-5 hidden">
<form id="password-form" class="space-y-5" novalidate>
<div>
<label for="password-email" class="block mb-1">Email</label>
<input
id="password-email"
type="email"
required
autocomplete="email"
class="w-full px-4 py-2 rounded-lg bg-[#2b2b2b] border border-[#DCDCDC] text-[#FAFAFA] focus:outline-none focus:ring-2 focus:ring-[#FF9900]"
placeholder="admin@idaic.org"
/>
</div>
<div>
<label for="password" class="block mb-1">Password</label>
<input
id="password"
type="password"
required
autocomplete="current-password"
class="w-full px-4 py-2 rounded-lg bg-[#2b2b2b] border border-[#DCDCDC] text-[#FAFAFA] focus:outline-none focus:ring-2 focus:ring-[#FF9900]"
placeholder="Enter password"
/>
</div>
<button
type="button"
id="password-submit-btn"
class="w-full py-2 bg-[#FF9900] hover:bg-orange-600 text-black rounded-lg font-semibold"
>
Sign in (Admin/Moderator)
</button>
</form>
</div>

<!-- Sign up text -->
<div class="text-center mt-4">
<span class="text-[#DCDCDC] text-sm">Not a member yet; </span>
<a
href="https://www.idaic.org/why-idaic"
target="_blank"
rel="noopener noreferrer"
class="text-[#FF9900] hover:text-orange-400 text-sm font-medium underline"
>
sign up now
</a>
</div>
</div>

<!-- Global notification live region -->
<div
aria-live="assertive"
id="notification-container"
class="pointer-events-none fixed inset-0 flex items-end px-4 py-6 sm:items-start sm:p-6"
>
<div
class="flex w-full flex-col items-center space-y-4 sm:items-end"
id="notification-list"
></div>
</div>

<!-- Start cookieyes banner --> <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/bcf616ad15c9632332d8f07f/script.js"></script> <!-- End cookieyes banner -->

<!-- Inject environment variables placeholder - Netlify will replace these at build time -->
<script>
  // Initialize ENV object - will be populated by Netlify function
  window.ENV = window.ENV || {};
  
  // Fetch environment variables before loading login module
  (async function() {
    try {
      const response = await fetch('/.netlify/functions/getEnv');
      if (response.ok) {
        const data = await response.json();
        window.ENV = data;
        console.log('✅ Environment variables loaded');
      } else {
        console.error('❌ Failed to fetch environment variables:', response.status);
      }
    } catch (error) {
      console.error('❌ Error loading environment variables:', error);
    }
    
    // Always dispatch event even if fetch failed
    window.dispatchEvent(new Event('envReady'));
  })();
</script>

<!-- Load login.js module -->
<script type="module" src="login.js"></script>
</body>
</html>

